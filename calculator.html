<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–º–µ—Ç—ã –æ—Ç–¥–µ–ª–∫–∏ —Ñ–∞—Å–∞–¥–∞ - –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä. –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç –æ–Ω–ª–∞–π–Ω –∑–∞ 4 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–º–µ—Ç—ã | –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- jsPDF –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* Header */
        .header {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-icon { width: 48px; height: 48px; background: #d35839; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 18px; }
        .logo-text h1 { font-size: 22px; color: #2c3e50; margin-bottom: 2px; }
        .logo-text p { font-size: 14px; color: #7f8c8d; }
        .phone { font-size: 20px; font-weight: 700; color: #d35839; text-decoration: none; }
        .phone:hover { opacity: 0.8; }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Main Grid */
        .main-grid { display: grid; grid-template-columns: 1fr 400px; gap: 30px; }

        /* Calculator Card */
        .calculator-card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 40px; }

        /* Progress Bar */
        .progress-section { margin-bottom: 40px; }
        .progress-title { text-align: center; color: #95a5a6; font-size: 14px; margin-bottom: 30px; }
        .progress-steps { display: flex; justify-content: space-between; align-items: center; position: relative; margin-bottom: 10px; }
        .progress-steps::before { content: ''; position: absolute; top: 20px; left: 0; right: 0; height: 2px; background: #ecf0f1; z-index: 0; }
        .progress-line { position: absolute; top: 20px; left: 0; height: 2px; background: #d35839; transition: width 0.3s ease; z-index: 1; }
        .step { display: flex; flex-direction: column; align-items: center; position: relative; z-index: 2; }
        .step-circle { width: 40px; height: 40px; border-radius: 50%; background: #ecf0f1; color: #95a5a6; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 8px; transition: all 0.3s ease; }
        .step.active .step-circle { background: #d35839; color: white; }
        .step.completed .step-circle { background: #27ae60; color: white; }
        .step.completed .step-circle::after { content: '‚úì'; }
        .step-label { font-size: 12px; color: #95a5a6; font-weight: 500; }
        .step.active .step-label { color: #d35839; font-weight: 600; }

        /* Step Content */
        .step-content { display: none; }
        .step-content.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .step-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
        .step-subtitle { color: #7f8c8d; margin-bottom: 30px; }

        /* Tip Box */
        .tip-box {
            background: #e8f5e9;
            border-left: 4px solid #27ae60;
            padding: 16px;
            margin-bottom: 24px;
            border-radius: 8px;
        }
        .tip-box strong { color: #27ae60; }

        /* Options Grid */
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .option-card { border: 2px solid #ecf0f1; border-radius: 12px; padding: 24px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: white; position: relative; }
        .option-card:hover { border-color: #d35839; transform: translateY(-4px); box-shadow: 0 4px 12px rgba(211,88,57,0.2); }
        .option-card.selected { border-color: #d35839; background: #fef5f1; }
        .option-icon { width: 60px; height: 60px; margin: 0 auto 16px; color: #d35839; }
        .option-title { font-size: 16px; font-weight: 600; margin-bottom: 8px; }
        .option-desc { font-size: 14px; color: #7f8c8d; margin-bottom: 12px; }
        .option-price { font-size: 18px; font-weight: 700; color: #d35839; }

        /* Input Field */
        .input-group { margin-bottom: 30px; }
        .input-label { display: block; font-weight: 600; margin-bottom: 12px; font-size: 16px; }
        .input-field { width: 100%; padding: 16px; font-size: 16px; border: 2px solid #ecf0f1; border-radius: 8px; font-family: inherit; }
        .input-field:focus { outline: none; border-color: #d35839; }
        .quick-sizes { display: flex; gap: 12px; margin-top: 12px; flex-wrap: wrap; }
        .quick-btn { padding: 8px 16px; border: 2px solid #ecf0f1; border-radius: 6px; background: white; cursor: pointer; font-weight: 500; transition: all 0.3s ease; }
        .quick-btn:hover { border-color: #d35839; color: #d35839; }

        /* Size Calculator */
        .size-calculator {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        .size-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
        .calculated-area {
            background: #d35839;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
        }
        .calculated-area-value { font-size: 32px; font-weight: 700; margin-top: 8px; }

        /* Checkboxes */
        .checkbox-list { display: flex; flex-direction: column; gap: 16px; margin-bottom: 30px; }
        .checkbox-item { display: flex; align-items: center; padding: 16px; border: 2px solid #ecf0f1; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; }
        .checkbox-item:hover { border-color: #d35839; background: #fef5f1; }
        .checkbox-item.checked { border-color: #d35839; background: #fef5f1; }
        .checkbox-item input { width: 20px; height: 20px; margin-right: 12px; cursor: pointer; }
        .checkbox-content { flex: 1; }
        .checkbox-title { font-weight: 600; margin-bottom: 4px; }
        .checkbox-desc { font-size: 13px; color: #7f8c8d; margin-bottom: 4px; }
        .checkbox-price { color: #d35839; font-weight: 600; }

        /* Navigation Buttons */
        .nav-buttons { display: flex; gap: 16px; }
        .btn { padding: 14px 28px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-family: inherit; }
        .btn-primary { background: #d35839; color: white; flex: 1; }
        .btn-primary:hover { background: #c14d31; }
        .btn-secondary { background: #ecf0f1; color: #7f8c8d; padding: 14px 24px; }
        .btn-secondary:hover { background: #d5dbdb; }
        .btn-success { background: #27ae60; color: white; flex: 1; }
        .btn-success:hover { background: #229954; }
        .btn-info { background: #3498db; color: white; flex: 1; }
        .btn-info:hover { background: #2980b9; }

        /* Estimate Card */
        .estimate-card { background: white; border: 2px solid #d35839; border-radius: 12px; padding: 30px; position: sticky; top: 20px; }
        .estimate-title { font-size: 20px; font-weight: 700; text-align: center; margin-bottom: 24px; color: #2c3e50; }
        .estimate-row { display: flex; justify-content: space-between; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #ecf0f1; font-size: 14px; }
        .estimate-row:last-child { border-bottom: none; }
        .estimate-label { color: #7f8c8d; }
        .estimate-value { font-weight: 600; color: #2c3e50; text-align: right; }

        /* Savings Box */
        .savings-box {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 16px 0;
            text-align: center;
        }
        .savings-title { font-size: 14px; opacity: 0.9; margin-bottom: 8px; }
        .savings-value { font-size: 24px; font-weight: 700; }
        .savings-subtitle { font-size: 12px; opacity: 0.8; margin-top: 4px; }

        /* Deadline Box */
        .deadline-box {
            background: #e3f2fd;
            border-left: 4px solid #3498db;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        .deadline-box strong { color: #3498db; }

        .estimate-total { margin-top: 24px; padding-top: 24px; border-top: 2px solid #d35839; display: flex; justify-content: space-between; align-items: center; }
        .estimate-total-label { font-size: 18px; font-weight: 600; }
        .estimate-total-value { font-size: 24px; font-weight: 700; color: #d35839; }
        .estimate-note { text-align: center; font-size: 12px; color: #95a5a6; margin-top: 16px; }

        /* Discount Badge */
        .discount-badge {
            background: #e74c3c;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            margin: 8px 0;
        }

        /* Contact Form */
        .contact-form { margin-top: 24px; padding-top: 24px; border-top: 1px solid #ecf0f1; }
        .form-input { width: 100%; padding: 12px; margin-bottom: 12px; border: 2px solid #ecf0f1; border-radius: 6px; font-family: inherit; }
        .form-input:focus { outline: none; border-color: #d35839; }
        .btn-submit { width: 100%; padding: 14px; background: #27ae60; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 12px; }
        .btn-submit:hover { background: #229954; }
        .btn-telegram { width: 100%; padding: 14px; background: #0088cc; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 12px; }
        .btn-telegram:hover { background: #006699; }
        .btn-new-calc { width: 100%; padding: 14px; background: #ecf0f1; color: #7f8c8d; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .btn-new-calc:hover { background: #d5dbdb; }

        /* Responsive */
        @media (max-width: 1024px) { .main-grid { grid-template-columns: 1fr; } .estimate-card { position: static; } }
        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 16px; text-align: center; }
            .calculator-card { padding: 24px; }
            .options-grid { grid-template-columns: 1fr; }
            .size-inputs { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">AD</div>
                <div class="logo-text">
                    <h1>–ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä</h1>
                    <p>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–º–µ—Ç—ã</p>
                </div>
            </div>
            <a href="tel:+79957767575" class="phone">+7 (995) 776-75-75</a>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Calculator -->
            <div class="calculator-card">
                <!-- Progress Bar -->
                <div class="progress-section">
                    <div class="progress-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                    <div class="progress-steps">
                        <div class="progress-line" id="progressLine" style="width: 0%"></div>
                        <div class="step active" data-step="1">
                            <div class="step-circle">1</div>
                            <div class="step-label">–¢–∏–ø —Ä–∞–±–æ—Ç</div>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-circle">2</div>
                            <div class="step-label">–ú–∞—Ç–µ—Ä–∏–∞–ª</div>
                        </div>
                        <div class="step" data-step="3">
                            <div class="step-circle">3</div>
                            <div class="step-label">–†–∞–∑–º–µ—Ä—ã</div>
                        </div>
                        <div class="step" data-step="4">
                            <div class="step-circle">4</div>
                            <div class="step-label">–£—Å–ª—É–≥–∏</div>
                        </div>
                    </div>
                </div>

                <!-- Steps Content -->
                <form id="calculatorForm">
                    <!-- Step 1: –¢–∏–ø —Ä–∞–±–æ—Ç -->
                    <div class="step-content active" data-step="1">
                        <h2 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞–±–æ—Ç</h2>
                        <p class="step-subtitle">–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</p>

                        <div class="tip-box">
                            <strong>üí° –°–æ–≤–µ—Ç:</strong> –£—Ç–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞—Å–∞–¥–∞ –æ–∫—É–ø–∏—Ç—Å—è –∑–∞ 3-5 –ª–µ—Ç –∑–∞ —Å—á—ë—Ç —ç–∫–æ–Ω–æ–º–∏–∏ –Ω–∞ –æ—Ç–æ–ø–ª–µ–Ω–∏–∏ –¥–æ 40%
                        </div>

                        <div class="options-grid">
                            <div class="option-card" data-type="facade" data-price="2000">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2"/><path d="M3 9h18M9 21V9" stroke-width="2"/></svg>
                                <div class="option-title">–û—Ç–¥–µ–ª–∫–∞ —Ñ–∞—Å–∞–¥–∞</div>
                                <div class="option-desc">–í–Ω–µ—à–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞ –∑–¥–∞–Ω–∏–π</div>
                            </div>
                            <div class="option-card" data-type="interior" data-price="1800">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="7" height="7" stroke-width="2"/><rect x="14" y="3" width="7" height="7" stroke-width="2"/><rect x="3" y="14" width="7" height="7" stroke-width="2"/><rect x="14" y="14" width="7" height="7" stroke-width="2"/></svg>
                                <div class="option-title">–û—Ç–¥–µ–ª–∫–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞</div>
                                <div class="option-desc">–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ –ø–æ–º–µ—â–µ–Ω–∏–π</div>
                            </div>
                            <div class="option-card" data-type="insulation" data-price="1400">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 7h16M4 12h16M4 17h16" stroke-width="2" stroke-linecap="round"/></svg>
                                <div class="option-title">–£—Ç–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞—Å–∞–¥–∞</div>
                                <div class="option-desc">–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è —Å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –æ—Ç–¥–µ–ª–∫–æ–π</div>
                            </div>
                        </div>

                        <div class="nav-buttons">
                            <button type="button" class="btn btn-primary" onclick="nextStep(2)">–î–∞–ª–µ–µ ‚Üí</button>
                        </div>
                    </div>

                    <!-- Step 2: –ú–∞—Ç–µ—Ä–∏–∞–ª -->
                    <div class="step-content" data-step="2">
                        <h2 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª</h2>
                        <p class="step-subtitle">–ù–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Ä–∞–±–æ—Ç</p>

                        <div class="tip-box">
                            <strong>‚ú® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> –¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª–∏ - —Å–∞–º–æ–µ –≤—ã–≥–æ–¥–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ 2 –≤ 1: —É—Ç–µ–ø–ª–µ–Ω–∏–µ + –æ—Ç–¥–µ–ª–∫–∞
                        </div>

                        <div class="options-grid">
                            <div class="option-card" data-material="penoplast50" data-material-price="350">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="2" y="4" width="20" height="4" stroke-width="2"/><rect x="2" y="10" width="9" height="4" stroke-width="2"/><rect x="13" y="10" width="9" height="4" stroke-width="2"/><rect x="2" y="16" width="20" height="4" stroke-width="2"/></svg>
                                <div class="option-title">–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 50–º–º</div>
                                <div class="option-desc">–•–æ—Ä–æ—à–∏–π —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ç–æ—Ä, —ç–∫–æ–Ω–æ–º–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</div>
                                <div class="option-price">350 ‚ÇΩ/–º¬≤</div>
                            </div>
                            <div class="option-card" data-material="penoplast100" data-material-price="650">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="2" y="4" width="20" height="4" stroke-width="2"/><rect x="2" y="10" width="9" height="4" stroke-width="2"/><rect x="13" y="10" width="9" height="4" stroke-width="2"/><rect x="2" y="16" width="20" height="4" stroke-width="2"/></svg>
                                <div class="option-title">–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 100–º–º</div>
                                <div class="option-desc">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è –∏ –∫–æ–º—Ñ–æ—Ä—Ç</div>
                                <div class="option-price">650 ‚ÇΩ/–º¬≤</div>
                            </div>
                            <div class="option-card" data-material="thermopanel" data-material-price="1200">
                                <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="4" y="4" width="16" height="16" stroke-width="2"/><path d="M8 8h8M8 12h8M8 16h8" stroke-width="2" stroke-linecap="round"/></svg>
                                <div class="option-title">–¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª–∏ –ø–æ–¥ –∫–∏—Ä–ø–∏—á</div>
                                <div class="option-desc">–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: —É—Ç–µ–ø–ª–µ–Ω–∏–µ + –∫—Ä–∞—Å–æ—Ç–∞</div>
                                <div class="option-price">1200 ‚ÇΩ/–º¬≤</div>
                            </div>
                        </div>

                        <div class="nav-buttons">
                            <button type="button" class="btn btn-secondary" onclick="prevStep(1)">‚Üê –ù–∞–∑–∞–¥</button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(3)">–î–∞–ª–µ–µ ‚Üí</button>
                        </div>
                    </div>

                    <!-- Step 3: –†–∞–∑–º–µ—Ä—ã -->
                    <div class="step-content" data-step="3">
                        <h2 class="step-title">–£–∫–∞–∂–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã —Å—Ç–µ–Ω—ã</h2>
                        <p class="step-subtitle">–í–≤–µ–¥–∏—Ç–µ –¥–ª–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø–ª–æ—â–∞–¥–∏</p>

                        <div class="tip-box">
                            <strong>üìè –ù–µ –∑–Ω–∞–µ—Ç–µ —Ç–æ—á–Ω—É—é –ø–ª–æ—â–∞–¥—å?</strong> –ú—ã –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ø—Ä–∏–µ–¥–µ–º –∏ –∑–∞–º–µ—Ä–∏–º!
                        </div>

                        <div class="size-calculator">
                            <h3 style="margin-bottom: 16px; font-size: 16px;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–ª–æ—â–∞–¥–∏</h3>
                            <div class="size-inputs">
                                <div>
                                    <label class="input-label">–î–ª–∏–Ω–∞ —Å—Ç–µ–Ω—ã (–º)</label>
                                    <input type="number" id="lengthInput" class="input-field" placeholder="15" min="1" oninput="calculateArea()">
                                </div>
                                <div>
                                    <label class="input-label">–í—ã—Å–æ—Ç–∞ —Å—Ç–µ–Ω—ã (–º)</label>
                                    <input type="number" id="heightInput" class="input-field" placeholder="2" min="1" oninput="calculateArea()">
                                </div>
                            </div>
                            <div class="calculated-area">
                                <div>–†–∞—Å—á–µ—Ç–Ω–∞—è –ø–ª–æ—â–∞–¥—å</div>
                                <div class="calculated-area-value" id="calculatedArea">0.00 –º¬≤</div>
                            </div>
                        </div>

                        <div class="quick-sizes">
                            <button type="button" class="quick-btn" onclick="setAreaDirect(30)">30 –º¬≤</button>
                            <button type="button" class="quick-btn" onclick="setAreaDirect(50)">50 –º¬≤</button>
                            <button type="button" class="quick-btn" onclick="setAreaDirect(100)">100 –º¬≤</button>
                            <button type="button" class="quick-btn" onclick="setAreaDirect(150)">150 –º¬≤</button>
                        </div>

                        <div class="nav-buttons" style="margin-top: 24px;">
                            <button type="button" class="btn btn-secondary" onclick="prevStep(2)">‚Üê –ù–∞–∑–∞–¥</button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(4)">–î–∞–ª–µ–µ ‚Üí</button>
                        </div>
                    </div>

                    <!-- Step 4: –£—Å–ª—É–≥–∏ -->
                    <div class="step-content" data-step="4">
                        <h2 class="step-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</h2>
                        <p class="step-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª—É–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</p>

                        <div class="tip-box">
                            <strong>üéÅ –ê–∫—Ü–∏—è!</strong> –ü—Ä–∏ –∑–∞–∫–∞–∑–µ –º–æ–Ω—Ç–∞–∂–∞ - –¥–æ—Å—Ç–∞–≤–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ë–ï–°–ü–õ–ê–¢–ù–û
                        </div>

                        <div class="checkbox-list">
                            <label class="checkbox-item">
                                <input type="checkbox" name="service" value="delivery" data-service-price="0" data-service-fixed="1000">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">–î–æ—Å—Ç–∞–≤–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                                    <div class="checkbox-desc">–î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç –≤ –ê—Ä–∑–∞–º–∞—Å</div>
                                    <div class="checkbox-price">1000 ‚ÇΩ</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" name="service" value="installation" data-service-price="350">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω—Ç–∞–∂</div>
                                    <div class="checkbox-desc">–†–∞–±–æ—Ç–∞ –æ–ø—ã—Ç–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</div>
                                    <div class="checkbox-price">350 ‚ÇΩ/–º¬≤</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" name="service" value="designer" data-service-price="0" data-service-fixed="500">
                                <div class="checkbox-content">
                                    <div class="checkbox-title">–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–µ—Ä–∞</div>
                                    <div class="checkbox-desc">–ü–æ–º–æ—â—å –≤ –≤—ã–±–æ—Ä–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏ —Ü–≤–µ—Ç–∞</div>
                                    <div class="checkbox-price">500 ‚ÇΩ</div>
                                </div>
                            </label>
                        </div>

                        <div class="nav-buttons">
                            <button type="button" class="btn btn-secondary" onclick="prevStep(3)">‚Üê –ù–∞–∑–∞–¥</button>
                            <button type="button" class="btn btn-success" onclick="finalizeEstimate()">üìÑ –ü–æ–ª—É—á–∏—Ç—å —Å–º–µ—Ç—É</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Estimate Sidebar -->
            <div class="estimate-card">
                <h3 class="estimate-title">–í–ê–®–ê –°–ú–ï–¢–ê</h3>

                <div id="estimateContent">
                    <div class="estimate-row">
                        <span class="estimate-label">–†–∞–±–æ—Ç—ã:</span>
                        <span class="estimate-value" id="workType">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–ú–∞—Ç–µ—Ä–∏–∞–ª:</span>
                        <span class="estimate-value" id="material">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–ü–ª–æ—â–∞–¥—å:</span>
                        <span class="estimate-value" id="area">0 –º¬≤</span>
                    </div>
                    <div class="estimate-row" id="baseCostRow" style="display: none;">
                        <span class="estimate-label">–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</span>
                        <span class="estimate-value" id="baseCost">0 ‚ÇΩ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–£—Å–ª—É–≥–∏:</span>
                        <span class="estimate-value" id="services">–ù–µ—Ç</span>
                    </div>
                </div>

                <!-- Savings Box -->
                <div class="savings-box" id="savingsBox" style="display: none;">
                    <div class="savings-title">üí∞ –í–∞—à–∞ —ç–∫–æ–Ω–æ–º–∏—è</div>
                    <div class="savings-value" id="savingsValue">6 000 ‚ÇΩ/–º–µ—Å</div>
                    <div class="savings-subtitle">–û–∫—É–ø–∞–µ–º–æ—Å—Ç—å: <span id="paybackPeriod">3.2 –≥–æ–¥–∞</span></div>
                </div>

                <!-- Deadline Box -->
                <div class="deadline-box" id="deadlineBox" style="display: none;">
                    <div><strong>‚è±Ô∏è –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</strong> <span id="deadline">7 –¥–Ω–µ–π</span></div>
                    <div style="font-size: 13px; margin-top: 4px;">–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: <span id="finishDate">31 –¥–µ–∫–∞–±—Ä—è</span></div>
                </div>

                <!-- Discount -->
                <div id="discountSection" style="display: none;">
                    <div class="discount-badge" id="discountBadge">üéÅ –°–∫–∏–¥–∫–∞ 10%: -3000 ‚ÇΩ</div>
                </div>

                <div class="estimate-total">
                    <span class="estimate-total-label">–ò–¢–û–ì–û:</span>
                    <span class="estimate-total-value" id="totalCost">0 ‚ÇΩ</span>
                </div>

                <p class="estimate-note">* –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–º–µ—Ä–∞</p>

                <div class="contact-form" id="contactForm" style="display: none;">
                    <input type="text" id="clientName" class="form-input" placeholder="–í–∞—à–µ –∏–º—è" required>
                    <input type="tel" id="clientPhone" class="form-input" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" required>
                    <button type="button" class="btn-submit" onclick="downloadPDF()">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>
                    <button type="button" class="btn-telegram" onclick="sendToTelegram()">üì± –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>
                    <button type="button" class="btn-new-calc" onclick="newCalculation()">üîÑ –ù–æ–≤—ã–π —Ä–∞—Å—á—ë—Ç</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let estimate = {
            workType: null,
            workTypeName: null,
            material: null,
            materialName: null,
            materialPrice: 0,
            area: 0,
            length: 0,
            height: 0,
            services: [],
            discount: 0
        };

        // Auto-save to localStorage
        function autoSave() {
            localStorage.setItem('estimateData', JSON.stringify(estimate));
        }

        // Load saved data
        window.onload = function() {
            const saved = localStorage.getItem('estimateData');
            if (saved && confirm('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞—Å—á—ë—Ç?')) {
                estimate = JSON.parse(saved);
                updateEstimateDisplay();
                showNotification('‚úÖ –†–∞—Å—á—ë—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => { notification.style.display = 'none'; }, 3000);
        }

        // Navigation
        function nextStep(step) {
            if (step === 2 && !estimate.workType) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞–±–æ—Ç');
                return;
            }
            if (step === 3 && !estimate.material) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª');
                return;
            }
            if (step === 4 && estimate.area === 0) {
                alert('–£–∫–∞–∂–∏—Ç–µ –ø–ª–æ—â–∞–¥—å');
                return;
            }

            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            document.querySelector(`.step-content[data-step="${step}"]`).classList.add('active');

            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.querySelector(`.step[data-step="${step}"]`).classList.add('active');

            for (let i = 1; i < step; i++) {
                document.querySelector(`.step[data-step="${i}"]`).classList.add('completed');
            }

            currentStep = step;
            updateProgress();
            updateEstimateDisplay();
            autoSave();
        }

        function prevStep(step) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            document.querySelector(`.step-content[data-step="${step}"]`).classList.add('active');

            document.querySelectorAll('.step').forEach(el => el.classList.remove('active', 'completed'));
            document.querySelector(`.step[data-step="${step}"]`).classList.add('active');

            for (let i = 1; i < step; i++) {
                document.querySelector(`.step[data-step="${i}"]`).classList.add('completed');
            }

            currentStep = step;
            updateProgress();
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progressLine').style.width = progress + '%';
        }

        // Work Type Selection
        document.querySelectorAll('[data-type]').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('[data-type]').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                estimate.workType = this.dataset.type;
                const types = { 'facade': '–û—Ç–¥–µ–ª–∫–∞ —Ñ–∞—Å–∞–¥–∞', 'interior': '–û—Ç–¥–µ–ª–∫–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞', 'insulation': '–£—Ç–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞—Å–∞–¥–∞' };
                estimate.workTypeName = types[estimate.workType];
                updateEstimateDisplay();
                autoSave();
            });
        });

        // Material Selection
        document.querySelectorAll('[data-material]').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('[data-material]').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                estimate.material = this.dataset.material;
                estimate.materialPrice = parseInt(this.dataset.materialPrice);
                const materials = { 'penoplast50': '–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 50–º–º', 'penoplast100': '–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 100–º–º', 'thermopanel': '–¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª–∏ –ø–æ–¥ –∫–∏—Ä–ø–∏—á' };
                estimate.materialName = materials[estimate.material];
                updateEstimateDisplay();
                autoSave();
            });
        });

        // Area Calculator
        function calculateArea() {
            const length = parseFloat(document.getElementById('lengthInput').value) || 0;
            const height = parseFloat(document.getElementById('heightInput').value) || 0;
            const area = length * height;
            
            estimate.length = length;
            estimate.height = height;
            estimate.area = area;
            
            document.getElementById('calculatedArea').textContent = area.toFixed(2) + ' –º¬≤';
            updateEstimateDisplay();
            autoSave();
        }

        function setAreaDirect(value) {
            estimate.area = value;
            document.getElementById('lengthInput').value = '';
            document.getElementById('heightInput').value = '';
            document.getElementById('calculatedArea').textContent = value.toFixed(2) + ' –º¬≤';
            updateEstimateDisplay();
            autoSave();
        }

        // Services
        document.querySelectorAll('input[name="service"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const pricePerM2 = parseInt(this.dataset.servicePrice) || 0;
                const fixedPrice = parseInt(this.dataset.serviceFixed) || 0;
                const serviceNames = { 'delivery': '–î–æ—Å—Ç–∞–≤–∫–∞', 'installation': '–ú–æ–Ω—Ç–∞–∂', 'designer': '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è' };
                
                if (this.checked) {
                    this.closest('.checkbox-item').classList.add('checked');
                    estimate.services.push({
                        name: this.value,
                        displayName: serviceNames[this.value],
                        pricePerM2: pricePerM2,
                        fixedPrice: fixedPrice
                    });
                } else {
                    this.closest('.checkbox-item').classList.remove('checked');
                    estimate.services = estimate.services.filter(s => s.name !== this.value);
                }
                updateEstimateDisplay();
                autoSave();
            });
        });

        // Calculate Discount
        function calculateDiscount(baseTotal) {
            let discount = 0;
            let reasons = [];

            if (estimate.area > 100) {
                discount += 5;
                reasons.push('–ü–ª–æ—â–∞–¥—å >100–º¬≤: -5%');
            }
            if (estimate.area > 200) {
                discount += 5;
                reasons.push('–ü–ª–æ—â–∞–¥—å >200–º¬≤: +5%');
            }

            const month = new Date().getMonth();
            if (month === 11) { // December
                discount += 5;
                reasons.push('–ó–∏–º–∞ 2024: -5%');
            }

            estimate.discount = discount;
            return { discount, reasons };
        }

        // Calculate Deadline
        function calculateDeadline(area) {
            let days = Math.ceil(area / 20); // 20 m¬≤/day
            if (estimate.services.find(s => s.name === 'installation')) days += 2;
            
            const startDate = new Date();
            startDate.setDate(startDate.getDate() + days);
            
            return {
                days: days,
                finishDate: startDate.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })
            };
        }

        // Update Estimate Display
        function updateEstimateDisplay() {
            document.getElementById('workType').textContent = estimate.workTypeName || '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            document.getElementById('material').textContent = estimate.materialName || '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            document.getElementById('area').textContent = estimate.area ? estimate.area.toFixed(2) + ' –º¬≤' : '0 –º¬≤';

            const servicesText = estimate.services.length > 0 
                ? estimate.services.map(s => s.displayName).join(', ')
                : '–ù–µ—Ç';
            document.getElementById('services').textContent = servicesText;

            // Calculate costs
            let materialCost = estimate.materialPrice * estimate.area;
            let servicesCost = 0;
            
            estimate.services.forEach(s => {
                servicesCost += (s.pricePerM2 * estimate.area) + s.fixedPrice;
            });

            let baseTotal = materialCost + servicesCost;
            document.getElementById('baseCost').textContent = baseTotal.toLocaleString('ru-RU') + ' ‚ÇΩ';
            document.getElementById('baseCostRow').style.display = baseTotal > 0 ? 'flex' : 'none';

            // Apply discount
            const discountInfo = calculateDiscount(baseTotal);
            const discountAmount = (baseTotal * discountInfo.discount) / 100;
            const total = baseTotal - discountAmount;

            if (discountInfo.discount > 0) {
                document.getElementById('discountSection').style.display = 'block';
                document.getElementById('discountBadge').textContent = `üéÅ –°–∫–∏–¥–∫–∞ ${discountInfo.discount}%: -${discountAmount.toLocaleString('ru-RU')} ‚ÇΩ`;
            } else {
                document.getElementById('discountSection').style.display = 'none';
            }

            document.getElementById('totalCost').textContent = total.toLocaleString('ru-RU') + ' ‚ÇΩ';

            // Show savings for insulation
            if (estimate.workType === 'insulation' && estimate.area > 0) {
                const monthlySavings = Math.round(estimate.area * 20);
                const payback = (total / (monthlySavings * 12)).toFixed(1);
                
                document.getElementById('savingsBox').style.display = 'block';
                document.getElementById('savingsValue').textContent = monthlySavings.toLocaleString('ru-RU') + ' ‚ÇΩ/–º–µ—Å';
                document.getElementById('paybackPeriod').textContent = payback + ' –≥–æ–¥–∞';
            } else {
                document.getElementById('savingsBox').style.display = 'none';
            }

            // Show deadline
            if (estimate.area > 0) {
                const deadline = calculateDeadline(estimate.area);
                document.getElementById('deadlineBox').style.display = 'block';
                document.getElementById('deadline').textContent = deadline.days + ' –¥–Ω–µ–π';
                document.getElementById('finishDate').textContent = deadline.finishDate;
            } else {
                document.getElementById('deadlineBox').style.display = 'none';
            }
        }

        function finalizeEstimate() {
            if (estimate.area === 0) {
                alert('–£–∫–∞–∂–∏—Ç–µ –ø–ª–æ—â–∞–¥—å');
                return;
            }
            document.getElementById('contactForm').style.display = 'block';
            showNotification('‚úÖ –°–º–µ—Ç–∞ –≥–æ—Ç–æ–≤–∞! –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã');
        }

        // Download PDF
        function downloadPDF() {
            const name = document.getElementById('clientName').value;
            const phone = document.getElementById('clientPhone').value;
            
            if (!name || !phone) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(20);
            doc.text('–°–ú–ï–¢–ê - –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä', 20, 20);
            
            doc.setFontSize(12);
            let y = 40;
            doc.text(`–ö–ª–∏–µ–Ω—Ç: ${name}`, 20, y); y += 10;
            doc.text(`–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`, 20, y); y += 10;
            doc.text(`–î–∞—Ç–∞: ${new Date().toLocaleDateString('ru-RU')}`, 20, y); y += 20;
            
            doc.text(`–†–∞–±–æ—Ç—ã: ${estimate.workTypeName}`, 20, y); y += 10;
            doc.text(`–ú–∞—Ç–µ—Ä–∏–∞–ª: ${estimate.materialName}`, 20, y); y += 10;
            doc.text(`–ü–ª–æ—â–∞–¥—å: ${estimate.area} –º¬≤`, 20, y); y += 10;
            
            if (estimate.services.length > 0) {
                doc.text(`–£—Å–ª—É–≥–∏: ${estimate.services.map(s => s.displayName).join(', ')}`, 20, y); y += 10;
            }
            
            y += 10;
            const total = document.getElementById('totalCost').textContent;
            doc.setFontSize(16);
            doc.text(`–ò–¢–û–ì–û: ${total}`, 20, y);
            
            doc.save(`–°–º–µ—Ç–∞_–ê—Ä–∑–∞–º–∞—Å_–î–µ–∫–æ—Ä_${Date.now()}.pdf`);
            showNotification('‚úÖ PDF —Å–∫–∞—á–∞–Ω!');
        }

        // Send to Telegram
        function sendToTelegram() {
            const name = document.getElementById('clientName').value;
            const phone = document.getElementById('clientPhone').value;
            
            if (!name || !phone) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω');
                return;
            }

            const total = document.getElementById('totalCost').textContent;
            const message = `üè† –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê\n\nüìã –†–∞–±–æ—Ç—ã: ${estimate.workTypeName}\nüß± –ú–∞—Ç–µ—Ä–∏–∞–ª: ${estimate.materialName}\nüìê –ü–ª–æ—â–∞–¥—å: ${estimate.area} –º¬≤\nüí∞ –ò–¢–û–ì–û: ${total}\n\nüë§ –ö–ª–∏–µ–Ω—Ç: ${name}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`;
            
            const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent('https://fenix52.github.io/calculator.html')}&text=${encodeURIComponent(message)}`;
            window.open(telegramUrl, '_blank');
            
            showNotification('‚úÖ –û—Ç–∫—Ä—ã—Ç Telegram!');
        }

        function newCalculation() {
            if (confirm('–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞—Å—á—ë—Ç? –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
                localStorage.removeItem('estimateData');
                location.reload();
            }
        }
    </script>
</body>
</html>