<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–º–µ—Ç—ã</title>

    <!-- Preload –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ -->
    <link rel="preload" href="/css/variables.css" as="style">
    <link rel="preload" href="/css/header.css" as="style">
    <link rel="preload" href="/css/footer.css" as="style">
    <link rel="preload" href="/assets/logo.svg" as="image">

    <!-- CSS -->
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">

    <!-- jsPDF –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
        }

        .notification.error {
            background: #e74c3c;
        }

        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        .calculator-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 40px;
        }

        .progress-section {
            margin-bottom: 40px;
        }

        .progress-title {
            text-align: center;
            color: #95a5a6;
            font-size: 14px;
            margin-bottom: 30px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            margin-bottom: 10px;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #ecf0f1;
            z-index: 0;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            height: 2px;
            background: #d35839;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            transition: opacity 0.3s;
        }

        .step.hidden {
            display: none;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ecf0f1;
            color: #95a5a6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            background: #d35839;
            color: white;
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: #27ae60;
            color: white;
        }

        .step-label {
            font-size: 12px;
            color: #95a5a6;
            font-weight: 500;
            text-align: center;
            white-space: nowrap;
        }

        .step.active .step-label {
            color: #d35839;
            font-weight: 600;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .step-subtitle {
            color: #7f8c8d;
            margin-bottom: 35px;
            font-size: 16px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .option-card {
            border: 2px solid #ecf0f1;
            border-radius: 12px;
            padding: 28px 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            position: relative;
            overflow: hidden;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(211,88,57,0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .option-card:hover {
            border-color: #d35839;
            transform: translateY(-6px);
            box-shadow: 0 8px 20px rgba(211,88,57,0.25);
        }

        .option-card:hover::before {
            opacity: 1;
        }

        .option-card.selected {
            border-color: #d35839;
            background: #fef5f1;
            box-shadow: 0 4px 12px rgba(211,88,57,0.2);
        }

        .option-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 18px;
            color: #d35839;
            fill: none;
        }

        .option-card.selected .option-icon {
            fill: none !important;
            animation: bounce 0.6s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .option-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .option-desc {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 14px;
            line-height: 1.5;
        }

        .option-price {
            font-size: 19px;
            font-weight: 700;
            color: #d35839;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 15px;
            color: #2c3e50;
        }

        .input-field {
            width: 100%;
            padding: 14px 16px;
            font-size: 16px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: #d35839;
            box-shadow: 0 0 0 3px rgba(211,88,57,0.1);
        }

        .input-field.error {
            border-color: #e74c3c;
        }

        .input-error {
            color: #e74c3c;
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }

        .input-field.error + .input-error {
            display: block;
        }

        .size-calculator {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            padding: 28px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 1px solid #ecf0f1;
        }

        .size-calculator h3 {
            margin-bottom: 20px;
            font-size: 18px;
            color: #2c3e50;
            font-weight: 600;
        }

        .size-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .calculated-area {
            background: linear-gradient(135deg, #d35839, #c14d31);
            color: white;
            padding: 24px;
            border-radius: 10px;
            text-align: center;
            font-size: 15px;
            box-shadow: 0 4px 12px rgba(211,88,57,0.3);
        }

        .calculated-area-value {
            font-size: 36px;
            font-weight: 700;
            margin-top: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .quick-sizes {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 10px 20px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
            color: #7f8c8d;
        }

        .quick-btn:hover {
            border-color: #d35839;
            color: #d35839;
            background: #fef5f1;
            transform: translateY(-2px);
        }

        .checkbox-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 30px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 18px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .checkbox-item:hover {
            border-color: #d35839;
            background: #fef5f1;
            transform: translateX(4px);
        }

        .checkbox-item.checked {
            border-color: #d35839;
            background: #fef5f1;
            box-shadow: 0 2px 8px rgba(211,88,57,0.15);
        }

        .checkbox-item input {
            width: 22px;
            height: 22px;
            margin-right: 14px;
            cursor: pointer;
            accent-color: #d35839;
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 15px;
        }

        .checkbox-desc {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .checkbox-price {
            color: #d35839;
            font-weight: 700;
            font-size: 15px;
        }

        .nav-buttons {
            display: flex;
            gap: 16px;
            margin-top: 30px;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #d35839, #c14d31);
            color: white;
            flex: 1;
            box-shadow: 0 4px 12px rgba(211,88,57,0.3);
        }

        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #c14d31, #a8402a);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(211,88,57,0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #7f8c8d;
            padding: 16px 28px;
        }

        .btn-secondary:hover {
            background: #d5dbdb;
            color: #2c3e50;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            flex: 1;
            box-shadow: 0 4px 12px rgba(39,174,96,0.3);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-2px);
        }

        .estimate-card {
            background: white;
            border: 2px solid #d35839;
            border-radius: 12px;
            padding: 30px;
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            box-shadow: 0 4px 16px rgba(211,88,57,0.15);
        }

        .estimate-title {
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 24px;
            color: #2c3e50;
        }

        .estimate-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 14px;
            padding-bottom: 14px;
            border-bottom: 1px solid #ecf0f1;
            font-size: 14px;
        }

        .estimate-row:last-child {
            border-bottom: none;
        }

        .estimate-label {
            color: #7f8c8d;
            font-weight: 500;
        }

        .estimate-value {
            font-weight: 600;
            color: #2c3e50;
            text-align: right;
        }

        .estimate-total {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 2px solid #d35839;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .estimate-total-label {
            font-size: 18px;
            font-weight: 700;
        }

        .estimate-total-value {
            font-size: 28px;
            font-weight: 700;
            color: #d35839;
            transition: all 0.3s;
        }

        .estimate-note {
            text-align: center;
            font-size: 12px;
            color: #95a5a6;
            margin-top: 16px;
            font-style: italic;
        }

        .contact-form {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 2px solid #ecf0f1;
            display: none;
        }

        .contact-form.show {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .contact-form h4 {
            font-size: 16px;
            margin-bottom: 16px;
            color: #2c3e50;
            text-align: center;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #d35839;
            box-shadow: 0 0 0 3px rgba(211,88,57,0.1);
        }

        .btn-submit,
        .btn-telegram,
        .btn-pdf {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
            font-family: inherit;
        }

        .btn-submit {
            background: #27ae60;
            color: white;
        }

        .btn-submit:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-telegram {
            background: #0088cc;
            color: white;
        }

        .btn-telegram:hover {
            background: #006699;
            transform: translateY(-2px);
        }

        .btn-pdf {
            background: #e74c3c;
            color: white;
        }

        .btn-pdf:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        /* AMK Configurator Styles */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 15px;
        }
        
        .content {
            display: grid;
            grid-template-columns: 600px 600px;
            gap: 20px;
            padding: 20px;
            justify-content: center;
        }

        .left-panel {
            width: 600px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        /* –ü–∞–ª–∏—Ç—Ä–∞ */
        .color-palette {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .color-option {
            position: relative;
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            aspect-ratio: 2/1;
        }

        .color-option-bg {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: transform 0.3s ease;
        }

        .color-option:hover .color-option-bg {
            transform: scale(1.1);
        }

        .color-option:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }

        .color-option.selected {
            border-color: #D65F4B;
            box-shadow: 0 0 0 2px #fff, 0 0 0 5px #D65F4B;
        }

        .color-label {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 4px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 15px;
            color: #333;
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
            z-index: 2;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–´–ô –ë–õ–û–ö –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê */
        .selection-calculator {
            background: #fff;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            padding: 0;
            overflow: hidden;            
            display: flex;
            flex-direction: column;
        }

        /* –¢–µ–ª–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        .calc-body {
            padding: 25px;
            display: grid;
            gap: 20px;
            flex: 1;
            align-content: center;
        }

        /* –í—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª */
        .calc-selection {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .calc-selection-left {
            flex: 1;
        }

        .calc-selection-label {
            font-size: 11px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .calc-selection-value {
            font-size: 28px;
            font-weight: 700;
            color: #212529;
        }

        /* –ë–ª–æ–∫ —Ü–µ–Ω—ã */
        .calc-price-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .calc-price-item {
            padding: 20px;
            background: white;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .calc-price-item:hover {
            border-color: #D65F4B;
            box-shadow: 0 4px 12px rgba(214, 95, 75, 0.15);
        }

        .calc-price-label {
            font-size: 11px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .calc-price-value {
            font-size: 32px;
            font-weight: 800;
            color: #212529;
            line-height: 1;
        }

        .calc-price-unit {
            font-size: 14px;
            color: #6c757d;
            font-weight: 600;
            margin-top: 5px;
        }

        /* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .right-panel {
            width: 600px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .view-controls {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .view-btn {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f0f0f0;
            color: #333;
        }

        .view-btn:hover {
            background: #e0e0e0;
            transform: translateY(-1px);
        }

        .view-btn.active {
            background: #D65F4B;
            color: white;
            box-shadow: 0 4px 12px rgba(214, 95, 75, 0.3);
        }

        /* –ì–∞–ª–µ—Ä–µ—è */
        .gallery-container {
            width: 600px;
            background: #f9f9f9;
            padding: 25px;
            border-radius: 12px;
            display: flex;
            align-items: start;
            justify-content: center;            
        }

        .gallery {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .gallery-item {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 3px solid transparent;
            aspect-ratio: 3/4;
            background: white;
        }

        .gallery-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .gallery-item.active {
            border-color: #D65F4B;
            box-shadow: 0 0 0 2px #fff, 0 0 0 5px #D65F4B;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .gallery-item-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 12px;
            font-size: 13px;
            font-weight: 600;
            text-align: center;
        }

        .gallery-item.active .gallery-item-label {
            background: linear-gradient(to top, rgba(214, 95, 75, 0.9), transparent);
            color: white;
        }

        .gallery-item::after {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            background: #D65F4B;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(214, 95, 75, 0.4);
        }

        .gallery-item.active::after {
            opacity: 1;
            transform: scale(1);
        }

        /* –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ */
        .characteristics {
            width: 600px;
            display: flex;
            align-items: start;            
        }

        .char-section {
            width: 100%;
            background: #f9f9f9;
            padding: 25px;
            border-radius: 12px;
        }

        .char-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .char-item {
            background: white;
            padding: 5px;
            border-radius: 6px;
            border-left: 4px solid #D65F4B;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .char-item:hover {
            transform: translateX(3px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .char-label {
            font-size: 10px;
            color: #666;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .char-value {
            font-size: 14px;
            font-weight: 700;
            color: #333;
        }

        /* –ö–ù–û–ü–ö–ê –î–ê–õ–ï–ï - –í–°–Ø –®–ò–†–ò–ù–ê */
        .next-button-container {
            width: 600px;
        }

        .next-button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #D65F4B 0%, #C44A36 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(214, 95, 75, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .next-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(214, 95, 75, 0.4);
        }

        .next-button:active {
            transform: translateY(0);
        }

        .next-button::after {
            content: '‚Üí';
            font-size: 20px;
            font-weight: bold;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1280px) {
            .content {
                grid-template-columns: 1fr;
                max-width: 600px;
                margin: 0 auto;
            }

            .left-panel,
            .right-panel,
            .gallery-container,
            .characteristics,
            .selection-calculator,
            .next-button-container {
                width: 100%;
                max-width: 600px;
                height: auto;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .content {
                padding: 15px;
                gap: 15px;
            }

            .color-palette {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .calc-price-section {
                grid-template-columns: 1fr;
            }

            .view-controls {
                flex-direction: column;
            }

            .view-btn {
                width: 100%;
            }

            .gallery {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .gallery-item {
                aspect-ratio: 16/9;
            }

            .char-grid {
                grid-template-columns: 1fr;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .gallery-item,
        .char-section {
            animation: fadeIn 0.4s ease;
        }

        .gallery-item:nth-child(1) { animation-delay: 0s; }
        .gallery-item:nth-child(2) { animation-delay: 0.1s; }
        .gallery-item:nth-child(3) { animation-delay: 0.2s; }
    

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr 350px;
            }
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .estimate-card {
                position: static;
                max-height: none;
            }

            .calculator-card {
                padding: 30px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                flex-direction: column;
                gap: 16px;
                text-align: center;
                padding: 20px;
            }

            .calculator-card {
                padding: 20px;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .size-inputs {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .step-title {
                font-size: 22px;
            }

            .content {
                grid-template-columns: 1fr !important;
            }

            .color-palette {
                grid-template-columns: repeat(2, 1fr) !important;
            }

            .gallery {
                grid-template-columns: 1fr !important;
            }
        }

        @media (max-width: 480px) {
            .quick-sizes {
                justify-content: center;
            }

            .quick-btn {
                flex: 1;
                min-width: 70px;
            }

            .step-label {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <!-- Header –∫–æ–º–ø–æ–Ω–µ–Ω—Ç -->
    <div id="header-placeholder"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
    <div class="notification" id="notification"></div>    
        <div class="main-grid">
            <div class="calculator-card">
                <div class="progress-section">
                    <div class="progress-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                    <div class="progress-steps" id="progressSteps">
                        <div class="progress-line" id="progressLine" style="width: 0%"></div>
                        <div class="step active" data-step-id="work-type">
                            <div class="step-circle">1</div>
                            <div class="step-label">–¢–∏–ø —Ä–∞–±–æ—Ç</div>
                        </div>
                        <div class="step" data-step-id="material">
                            <div class="step-circle">2</div>
                            <div class="step-label">–ú–∞—Ç–µ—Ä–∏–∞–ª</div>
                        </div>
                        <div class="step hidden" data-step-id="configurator">
                            <div class="step-circle">3</div>
                            <div class="step-label">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä</div>
                        </div>
                        <div class="step" data-step-id="dimensions">
                            <div class="step-circle">3</div>
                            <div class="step-label">–†–∞–∑–º–µ—Ä—ã</div>
                        </div>
                        <div class="step" data-step-id="services">
                            <div class="step-circle">4</div>
                            <div class="step-label">–£—Å–ª—É–≥–∏</div>
                        </div>
                    </div>
                </div>

                <div class="step-content active" data-step="work-type">
                    <h2 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞–±–æ—Ç</h2>
                    <p class="step-subtitle">–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</p>

                    <div class="options-grid">
                        <div class="option-card" data-type="facade">
                            <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2"/>
                                <path d="M3 9h18M9 21V9" stroke-width="2"/>
                            </svg>
                            <div class="option-title">–û—Ç–¥–µ–ª–∫–∞ —Ñ–∞—Å–∞–¥–∞</div>
                            <div class="option-desc">–í–Ω–µ—à–Ω—è—è –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞ –∑–¥–∞–Ω–∏—è</div>
                        </div>

                        <div class="option-card" data-type="interior">
                            <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="3" width="7" height="7" stroke-width="2"/>
                                <rect x="14" y="3" width="7" height="7" stroke-width="2"/>
                                <rect x="3" y="14" width="7" height="7" stroke-width="2"/>
                                <rect x="14" y="14" width="7" height="7" stroke-width="2"/>
                            </svg>
                            <div class="option-title">–û—Ç–¥–µ–ª–∫–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞</div>
                            <div class="option-desc">–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ –ø–æ–º–µ—â–µ–Ω–∏–π</div>
                        </div>

                        <div class="option-card" data-type="insulation">
                            <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M4 7h16M4 12h16M4 17h16" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <div class="option-title">–£—Ç–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞—Å–∞–¥–∞</div>
                            <div class="option-desc">–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è –Ω–∞—Ä—É–∂–Ω—ã—Ö —Å—Ç–µ–Ω</div>
                        </div>
                    </div>

                    <div class="nav-buttons">
                        <button type="button" class="btn btn-primary" id="step1Next" disabled>–î–∞–ª–µ–µ ‚Üí</button>
                    </div>
                </div>

                <div class="step-content" data-step="material">
                    <h2 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª</h2>
                    <p class="step-subtitle">–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞</p>

                    <div class="options-grid" id="materialsGrid"></div>

                    <div class="nav-buttons">
                        <button type="button" class="btn btn-secondary" onclick="goToPrevStep()">‚Üê –ù–∞–∑–∞–¥</button>
                        <button type="button" class="btn btn-primary" id="step2Next" disabled>–î–∞–ª–µ–µ ‚Üí</button>
                    </div>
                </div>

                <div class="step-content" data-step="configurator">
                    <h2 class="step-title">üß± –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –≥–∏–±–∫–æ–≥–æ –∫–∏—Ä–ø–∏—á–∞</h2>
                    <p class="step-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–æ–≤–æ–π –º–∏–∫—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç</p>

    <div class="container">
        <div class="content">
            <div class="left-panel">
                <h2 class="section-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–æ–≤–æ–π –º–∏–∫—Å</h2>
                <div class="color-palette" id="colorPalette"></div>

                <!-- –ö–û–ú–ü–ê–ö–¢–ù–´–ô –ë–õ–û–ö –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê -->
                <div class="selection-calculator">
                    <div class="calc-body">
                        <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª -->
                        <div class="calc-selection">
                            <div class="calc-selection-left">
                                <div class="calc-selection-label">–í—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</div>
                                <div class="calc-selection-value" id="selectionText">–º–∏–∫—Å 100</div>
                            </div>                            
                        </div>

                        <!-- –¶–µ–Ω–∞ -->
                        <div class="calc-price-section">
                            <div class="calc-price-item">
                                <div class="calc-price-label">–¶–µ–Ω–∞ –∑–∞ –ª–∏—Å—Ç</div>
                                <div class="calc-price-value" id="priceValue">1080</div>
                                <div class="calc-price-unit">‚ÇΩ/–ª–∏—Å—Ç</div>
                            </div>
                            <div class="calc-price-item">
                                <div class="calc-price-label">–ü–ª–æ—â–∞–¥—å –ª–∏—Å—Ç–∞</div>
                                <div class="calc-price-value">0.9</div>
                                <div class="calc-price-unit">–º¬≤</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="view-controls">
                    <button class="view-btn active" data-view="photos">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</button>
                    <button class="view-btn" data-view="specs">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</button>
                </div>

                <div class="gallery-container" id="photoGallery">
                    <div class="gallery">
                        <div class="gallery-item active" data-type="exterior">
                            <img src="100.jpg" alt="–§–∞—Å–∞–¥" id="exteriorImage">
                            <div class="gallery-item-label">–§–∞—Å–∞–¥</div>
                        </div>
                        <div class="gallery-item" data-type="interior">
                            <img src="100-1.jpg" alt="–ò–Ω—Ç–µ—Ä—å–µ—Ä" id="interiorImage">
                            <div class="gallery-item-label">–ò–Ω—Ç–µ—Ä—å–µ—Ä</div>
                        </div>
                        <div class="gallery-item" data-type="balcony">
                            <img src="100-2.jpg" alt="–ë–∞–ª–∫–æ–Ω" id="balconyImage">
                            <div class="gallery-item-label">–ë–∞–ª–∫–æ–Ω</div>
                        </div>
                    </div>
                </div>

                <div class="characteristics" id="specifications" style="display: none;">
                    <div class="char-section">
                        <h3 class="section-title">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                        <div class="char-grid">
                            <div class="char-item">
                                <div class="char-label">–†–∞–∑–º–µ—Ä –ª–∏—Å—Ç–∞</div>
                                <div class="char-value">0.9 –º¬≤</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–°–æ—Å—Ç–∞–≤</div>
                                <div class="char-value">–ú—Ä–∞–º–æ—Ä–Ω–∞—è –∫—Ä–æ—à–∫–∞</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div>
                                <div class="char-value">-50¬∞ –¥–æ +70¬∞C</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–ê–¥–≥–µ–∑–∏—è</div>
                                <div class="char-value">‚â• 1.0 –ú–ü–∞</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–ü–∞—Ä–æ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å</div>
                                <div class="char-value">0.17 –º¬≤¬∑—á¬∑–ü–∞/–º–≥</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–ú–æ–Ω—Ç–∞–∂</div>
                                <div class="char-value">–ù–∞ –∫–ª–µ–π</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–ü–æ–∂–∞—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
                                <div class="char-value">–°–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</div>
                            </div>
                            <div class="char-item">
                                <div class="char-label">–í–µ—Å</div>
                                <div class="char-value">–õ–µ–≥–∫–∏–π</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ö–ù–û–ü–ö–ê –î–ê–õ–ï–ï - –í–°–Ø –®–ò–†–ò–ù–ê -->
                <div class="next-button-container">
                    <button class="next-button" style="display:none;" onclick="handleNext()">–î–∞–ª–µ–µ</button>
                </div>
            </div>
        </div>
    </div>

    

                    <div class="nav-buttons">
                        <button type="button" class="btn btn-secondary" onclick="goToPrevStep()">‚Üê –ù–∞–∑–∞–¥</button>
                        <button type="button" class="btn btn-primary" onclick="goToNextStep()">–î–∞–ª–µ–µ ‚Üí</button>
                    </div>
                </div>

                <div class="step-content" data-step="dimensions">
                    <h2 class="step-title">–£–∫–∞–∂–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã</h2>
                    <p class="step-subtitle">–î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏</p>

                    <div class="size-calculator">
                        <h3>üìê –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–ª–æ—â–∞–¥–∏</h3>
                        <div class="size-inputs">
                            <div>
                                <label class="input-label">–î–ª–∏–Ω–∞ (–º)</label>
                                <input type="number" id="lengthInput" class="input-field" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 15" min="0.1" max="1000" step="0.1">
                                <div class="input-error">–í–≤–µ–¥–∏—Ç–µ –¥–ª–∏–Ω—É –æ—Ç 0.1 –¥–æ 1000 –º</div>
                            </div>
                            <div>
                                <label class="input-label">–í—ã—Å–æ—Ç–∞ (–º)</label>
                                <input type="number" id="heightInput" class="input-field" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2.5" min="0.1" max="100" step="0.1">
                                <div class="input-error">–í–≤–µ–¥–∏—Ç–µ –≤—ã—Å–æ—Ç—É –æ—Ç 0.1 –¥–æ 100 –º</div>
                            </div>
                        </div>
                        <div class="calculated-area">
                            <div>üìè –ü–ª–æ—â–∞–¥—å:</div>
                            <div class="calculated-area-value" id="calculatedArea">0.00 –º¬≤</div>
                        </div>
                    </div>

                    <div class="quick-sizes">
                        <button type="button" class="quick-btn" onclick="setQuickArea(30)">30 –º¬≤</button>
                        <button type="button" class="quick-btn" onclick="setQuickArea(50)">50 –º¬≤</button>
                        <button type="button" class="quick-btn" onclick="setQuickArea(100)">100 –º¬≤</button>
                        <button type="button" class="quick-btn" onclick="setQuickArea(150)">150 –º¬≤</button>
                    </div>

                    <div class="nav-buttons">
                        <button type="button" class="btn btn-secondary" onclick="goToPrevStep()">‚Üê –ù–∞–∑–∞–¥</button>
                        <button type="button" class="btn btn-primary" id="step4Next" disabled>–î–∞–ª–µ–µ ‚Üí</button>
                    </div>
                </div>

                <div class="step-content" data-step="services">
                    <h2 class="step-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</h2>
                    <p class="step-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª—É–≥–∏</p>

                    <div class="checkbox-list">
                        <label class="checkbox-item">
                            <input type="checkbox" value="delivery" data-fixed="1000">
                            <div class="checkbox-content">
                                <div class="checkbox-title">üöö –î–æ—Å—Ç–∞–≤–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                                <div class="checkbox-desc">–î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç –ø–æ –ê—Ä–∑–∞–º–∞—Å—É</div>
                                <div class="checkbox-price">1000 ‚ÇΩ</div>
                            </div>
                        </label>

                        <label class="checkbox-item">
                            <input type="checkbox" value="installation" data-perm2="350">
                            <div class="checkbox-content">
                                <div class="checkbox-title">üî® –ú–æ–Ω—Ç–∞–∂ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                                <div class="checkbox-desc">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</div>
                                <div class="checkbox-price">350 ‚ÇΩ/–º¬≤</div>
                            </div>
                        </label>

                        <label class="checkbox-item">
                            <input type="checkbox" value="designer" data-fixed="500">
                            <div class="checkbox-content">
                                <div class="checkbox-title">‚ú® –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–µ—Ä–∞</div>
                                <div class="checkbox-desc">–ü–æ–º–æ—â—å –≤ –ø–æ–¥–±–æ—Ä–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                                <div class="checkbox-price">500 ‚ÇΩ</div>
                            </div>
                        </label>
                    </div>

                    <div class="nav-buttons">
                        <button type="button" class="btn btn-secondary" onclick="goToPrevStep()">‚Üê –ù–∞–∑–∞–¥</button>
                        <button type="button" class="btn btn-success" onclick="finalizeCalculator()">–ü–æ–ª—É—á–∏—Ç—å —Å–º–µ—Ç—É üìÑ</button>
                    </div>
                </div>
            </div>

            <div class="estimate-card">
                <h3 class="estimate-title">–í–ê–®–ê –°–ú–ï–¢–ê</h3>

                <div>
                    <div class="estimate-row">
                        <span class="estimate-label">–†–∞–±–æ—Ç—ã:</span>
                        <span class="estimate-value" id="displayWorkType">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–ú–∞—Ç–µ—Ä–∏–∞–ª:</span>
                        <span class="estimate-value" id="displayMaterial">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–ü–ª–æ—â–∞–¥—å:</span>
                        <span class="estimate-value" id="displayArea">0 –º¬≤</span>
                    </div>
                    <div class="estimate-row" id="sheetsRow" style="display: none;">
                        <span class="estimate-label">–õ–∏—Å—Ç–æ–≤:</span>
                        <span class="estimate-value" id="displaySheets">0 —à—Ç</span>
                    </div>
                    <div class="estimate-row" id="materialCostRow" style="display: none;">
                        <span class="estimate-label">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:</span>
                        <span class="estimate-value" id="displayMaterialCost">0 ‚ÇΩ</span>
                    </div>
                    <div class="estimate-row">
                        <span class="estimate-label">–£—Å–ª—É–≥–∏:</span>
                        <span class="estimate-value" id="displayServices">–ù–µ—Ç</span>
                    </div>
                </div>

                <div class="estimate-total">
                    <span class="estimate-total-label">–ò–¢–û–ì–û:</span>
                    <span class="estimate-total-value" id="displayTotal">0 ‚ÇΩ</span>
                </div>

                <p class="estimate-note">* –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–º–µ—Ä–∞</p>

                <div class="contact-form" id="contactForm">
                    <h4>üìû –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</h4>
                    <input type="text" id="clientName" class="form-input" placeholder="–í–∞—à–µ –∏–º—è" required>
                    <input type="tel" id="clientPhone" class="form-input" placeholder="+7 (___) ___-__-__" required>
                    <button type="button" class="btn-pdf" onclick="downloadPDF()">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>
                    <button type="button" class="btn-telegram" onclick="sendToTelegram()">‚úàÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>
                    <button type="button" class="btn-submit" onclick="submitForm()">üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
                </div>
            </div>
        </div>    

    <!-- Footer –∫–æ–º–ø–æ–Ω–µ–Ω—Ç -->
    <div id="footer-placeholder"></div>

    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ -->
    <script src="/js/components.js"></script>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
    <script>
        let calculatorData = {
            workType: null,
            workTypeName: null,
            material: null,
            materialName: null,
            materialPrice: 0,
            materialUnit: 'm2',
            sheetArea: 0,
            area: 0,
            services: [],
            amkMix: null,
            hasConfigurator: false,
            timestamp: null
        };

        const STEP_ORDER = ['work-type', 'material', 'configurator', 'dimensions', 'services'];
        let currentStepIndex = 0;

        const materialsByType = {
            facade: [
                {
                    id: 'flexible-brick',
                    name: '–ì–∏–±–∫–∏–π –∫–∏—Ä–ø–∏—á',
                    desc: '–û–±–ª–∏—Ü–æ–≤–∫–∞ –≥–∏–±–∫–∏–º –∫–∏—Ä–ø–∏—á–æ–º, –ª–µ–≥–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª (2-3 –∫–≥/–º¬≤)',
                    price: 1080,
                    unit: '–ª–∏—Å—Ç',
                    sheetArea: 0.9,
                    hasAMK: true,
                    icon: '<rect x="4" y="4" width="16" height="16" stroke-width="2"/><path d="M8 8h8M8 12h8M8 16h8" stroke-width="2"/>'
                },
                {
                    id: 'thermal-brick',
                    name: '–¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª—å –ø–æ–¥ –∫–∏—Ä–ø–∏—á',
                    desc: '–£—Ç–µ–ø–ª–µ–Ω–∏–µ —Å –¥–µ–∫–æ—Ä–æ–º',
                    price: 850,
                    icon: '<rect x="2" y="4" width="20" height="4" stroke-width="2"/><rect x="2" y="10" width="9" height="4" stroke-width="2"/>'
                },
                {
                    id: 'facade-decor',
                    name: '–§–∞—Å–∞–¥–Ω—ã–π –ª–µ–ø–Ω–æ–π –¥–µ–∫–æ—Ä',
                    desc: '–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ñ–∞—Å–∞–¥–∞',
                    price: 1200,
                    icon: '<circle cx="12" cy="12" r="8" stroke-width="2"/><path d="M12 8v8M8 12h8" stroke-width="2"/>'
                }
            ],
            interior: [
                {
                    id: 'flexible-brick',
                    name: '–ì–∏–±–∫–∏–π –∫–∏—Ä–ø–∏—á',
                    desc: '–ò–Ω—Ç–µ—Ä—å–µ—Ä–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞, —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª',
                    price: 1080,
                    unit: '–ª–∏—Å—Ç',
                    sheetArea: 0.9,
                    hasAMK: true,
                    icon: '<rect x="4" y="4" width="16" height="16" stroke-width="2"/><path d="M8 8h8M8 12h8M8 16h8" stroke-width="2"/>'
                },
                {
                    id: 'interior-decor',
                    name: '–õ–µ–ø–Ω–æ–π –¥–µ–∫–æ—Ä',
                    desc: '–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞',
                    price: 1500,
                    icon: '<path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke-width="2"/>'
                },
                {
                    id: 'thermal-brick',
                    name: '–¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª—å –ø–æ–¥ –∫–∏—Ä–ø–∏—á',
                    desc: '–£—Ç–µ–ø–ª–µ–Ω–∏–µ –∏ –∑–≤—É–∫–æ–∏–∑–æ–ª—è—Ü–∏—è',
                    price: 850,
                    icon: '<rect x="2" y="4" width="20" height="4" stroke-width="2"/>'
                }
            ],
            insulation: [
                {
                    id: 'penoplast50',
                    name: '–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 50–º–º',
                    desc: '–ë–∞–∑–æ–≤–∞—è —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è, —ç–∫–æ–Ω–æ–º–∏—è –¥–æ 30%',
                    price: 350,
                    icon: '<rect x="2" y="4" width="20" height="4" stroke-width="2"/>'
                },
                {
                    id: 'penoplast100',
                    name: '–ü–µ–Ω–æ–ø–ª–∞—Å—Ç 100–º–º',
                    desc: '–£—Å–∏–ª–µ–Ω–Ω–∞—è —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è, —ç–∫–æ–Ω–æ–º–∏—è –¥–æ 50%',
                    price: 650,
                    icon: '<rect x="2" y="4" width="20" height="4" stroke-width="2"/>'
                },
                {
                    id: 'thermopanel',
                    name: '–¢–µ—Ä–º–æ–ø–∞–Ω–µ–ª—å',
                    desc: '–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —É—Ç–µ–ø–ª–µ–Ω–∏–µ —Å –¥–µ–∫–æ—Ä–æ–º',
                    price: 1200,
                    icon: '<rect x="4" y="4" width="16" height="16" stroke-width="2"/>'
                }
            ]
        };

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification' + (type === 'error' ? ' error' : '');
            notification.style.display = 'block';
            setTimeout(() => { notification.style.display = 'none'; }, 3000);
        }

        function saveToLocalStorage() {
            calculatorData.timestamp = new Date().toISOString();
            localStorage.setItem('arzamas_decor_calculator', JSON.stringify(calculatorData));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('arzamas_decor_calculator');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    const savedTime = new Date(data.timestamp);
                    const now = new Date();
                    const hoursDiff = (now - savedTime) / (1000 * 60 * 60);
                    if (hoursDiff < 24 && confirm('–ù–∞–π–¥–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                        calculatorData = data;
                        restoreUI();
                        showNotification('–î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
                        return true;
                    }
                } catch (e) { console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e); }
            }
            return false;
        }

        function restoreUI() {
            if (calculatorData.workType) {
                const card = document.querySelector(`[data-type="${calculatorData.workType}"]`);
                if (card) card.classList.add('selected');
                loadMaterials(calculatorData.workType);
                document.getElementById('step1Next').disabled = false;
            }
            if (calculatorData.material) {
                setTimeout(() => {
                    const card = document.querySelector(`[data-material-id="${calculatorData.material}"]`);
                    if (card) card.classList.add('selected');
                    updateProgressBar();
                    document.getElementById('step2Next').disabled = false;
                }, 100);
            }
            if (calculatorData.area > 0) {
                document.getElementById('calculatedArea').textContent = calculatorData.area.toFixed(2) + ' –º¬≤';
                document.getElementById('step4Next').disabled = false;
            }
            updateDisplay();
        }

        function getVisibleSteps() {
            return calculatorData.hasConfigurator ? STEP_ORDER : STEP_ORDER.filter(s => s !== 'configurator');
        }

        function getCurrentStepId() {
            return getVisibleSteps()[currentStepIndex];
        }

        function updateProgressBar() {
            const visibleSteps = getVisibleSteps();
            const totalSteps = visibleSteps.length;
            const configuratorStep = document.querySelector('.step[data-step-id="configurator"]');

            if (calculatorData.hasConfigurator) {
                configuratorStep.classList.remove('hidden');
            } else {
                configuratorStep.classList.add('hidden');
            }

            const steps = document.querySelectorAll('.step:not(.hidden)');
            steps.forEach((step, index) => {
                step.querySelector('.step-circle').textContent = index + 1;
            });

            document.querySelectorAll('.step').forEach(el => el.classList.remove('active', 'completed'));

            visibleSteps.forEach((stepId, index) => {
                const stepEl = document.querySelector(`.step[data-step-id="${stepId}"]`);
                if (index < currentStepIndex) {
                    stepEl.classList.add('completed');
                } else if (index === currentStepIndex) {
                    stepEl.classList.add('active');
                }
            });

            const progress = ((currentStepIndex + 1) / totalSteps) * 100;
            document.getElementById('progressLine').style.width = progress + '%';
        }

        function changeStep(direction) {
            const visibleSteps = getVisibleSteps();
            if (direction === 'next' && currentStepIndex < visibleSteps.length - 1) {
                currentStepIndex++;
            } else if (direction === 'prev' && currentStepIndex > 0) {
                currentStepIndex--;
            }
            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            const currentStepId = getCurrentStepId();
            const currentContent = document.querySelector(`.step-content[data-step="${currentStepId}"]`);
            if (currentContent) currentContent.classList.add('active');
            updateProgressBar();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function goToNextStep() { changeStep('next'); }
        function goToPrevStep() { changeStep('prev'); }

        function validateNumberInput(input, min, max) {
            const value = parseFloat(input.value);
            if (input.value === '') {
                input.classList.remove('error');
                return true;
            }
            if (isNaN(value) || value < min || value > max) {
                input.classList.add('error');
                return false;
            }
            input.classList.remove('error');
            return true;
        }

        function validatePhone(phone) {
            return phone.replace(/[^0-9]/g, '').length >= 10;
        }

        function formatPhone(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            if (value.length > 0) {
                if (value[0] === '8') value = '7' + value.slice(1);
                if (value[0] !== '7') value = '7' + value;
            }
            let formatted = '+7';
            if (value.length > 1) formatted += ' (' + value.substring(1, 4);
            if (value.length >= 5) formatted += ') ' + value.substring(4, 7);
            if (value.length >= 8) formatted += '-' + value.substring(7, 9);
            if (value.length >= 10) formatted += '-' + value.substring(9, 11);
            input.value = formatted;
        }

        function loadMaterials(workType) {
            const grid = document.getElementById('materialsGrid');
            grid.innerHTML = '';
            const materials = materialsByType[workType] || [];
            materials.forEach(mat => {
                const card = document.createElement('div');
                card.className = 'option-card';
                card.dataset.materialId = mat.id;
                card.dataset.hasAmk = mat.hasAMK || false;
                card.innerHTML = `
                    <svg class="option-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        ${mat.icon}
                    </svg>
                    <div class="option-title">${mat.name}</div>
                    <div class="option-desc">${mat.desc}</div>
                    <div class="option-price">${mat.price} ‚ÇΩ${mat.unit ? '/' + mat.unit : '/–º¬≤'}</div>
                `;
                card.addEventListener('click', () => selectMaterial(mat, card));
                grid.appendChild(card);
            });
        }

        function selectMaterial(mat, cardElement) {
            document.querySelectorAll('#materialsGrid .option-card').forEach(c => c.classList.remove('selected'));
            cardElement.classList.add('selected');
            calculatorData.material = mat.id;
            calculatorData.materialName = mat.name;
            calculatorData.materialPrice = mat.price;
            calculatorData.materialUnit = mat.unit || 'm2';
            calculatorData.sheetArea = mat.sheetArea || 0;
            calculatorData.hasConfigurator = mat.hasAMK || false;
            updateProgressBar();
            document.getElementById('step2Next').disabled = false;
            saveToLocalStorage();
            updateDisplay();
            showNotification(`–ú–∞—Ç–µ—Ä–∏–∞–ª "${mat.name}" –≤—ã–±—Ä–∞–Ω`);
        }

        document.querySelectorAll('[data-type]').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('[data-type]').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                calculatorData.workType = this.dataset.type;
                const names = { facade: '–û—Ç–¥–µ–ª–∫–∞ —Ñ–∞—Å–∞–¥–∞', interior: '–û—Ç–¥–µ–ª–∫–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞', insulation: '–£—Ç–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞—Å–∞–¥–∞' };
                calculatorData.workTypeName = names[calculatorData.workType];
                loadMaterials(calculatorData.workType);
                document.getElementById('step1Next').disabled = false;
                saveToLocalStorage();
                updateDisplay();
            });
        });

        document.getElementById('step1Next').addEventListener('click', () => {
            if (!calculatorData.workType) { showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞–±–æ—Ç', 'error'); return; }
            goToNextStep();
        });

        document.getElementById('step2Next').addEventListener('click', () => {
            if (!calculatorData.material) { showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª', 'error'); return; }
            goToNextStep();
        });

        document.getElementById('step4Next').addEventListener('click', () => {
            if (calculatorData.area === 0) { showNotification('–£–∫–∞–∂–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', 'error'); return; }
            goToNextStep();
        });

        const lengthInput = document.getElementById('lengthInput');
        const heightInput = document.getElementById('heightInput');
        lengthInput.addEventListener('input', function() { validateNumberInput(this, 0.1, 1000); calcAreaFromInputs(); });
        heightInput.addEventListener('input', function() { validateNumberInput(this, 0.1, 100); calcAreaFromInputs(); });

        function calcAreaFromInputs() {
            const len = parseFloat(lengthInput.value) || 0;
            const hei = parseFloat(heightInput.value) || 0;
            if (validateNumberInput(lengthInput, 0.1, 1000) && validateNumberInput(heightInput, 0.1, 100)) {
                const area = len * hei;
                calculatorData.area = area;
                document.getElementById('calculatedArea').textContent = area.toFixed(2) + ' –º¬≤';
                document.getElementById('step4Next').disabled = area === 0;
                saveToLocalStorage();
                updateDisplay();
            }
        }

        function setQuickArea(value) {
            calculatorData.area = value;
            lengthInput.value = ''; heightInput.value = '';
            lengthInput.classList.remove('error'); heightInput.classList.remove('error');
            document.getElementById('calculatedArea').textContent = value.toFixed(2) + ' –º¬≤';
            document.getElementById('step4Next').disabled = false;
            saveToLocalStorage();
            updateDisplay();
        }

        document.querySelectorAll('.checkbox-item input').forEach(cb => {
            cb.addEventListener('change', function() {
                const fixed = parseInt(this.dataset.fixed) || 0;
                const perM2 = parseInt(this.dataset.perm2) || 0;
                if (this.checked) {
                    this.closest('.checkbox-item').classList.add('checked');
                    calculatorData.services.push({ id: this.value, fixed: fixed, perM2: perM2 });
                } else {
                    this.closest('.checkbox-item').classList.remove('checked');
                    calculatorData.services = calculatorData.services.filter(s => s.id !== this.value);
                }
                saveToLocalStorage();
                updateDisplay();
            });
        });

        function updateDisplay() {
            document.getElementById('displayWorkType').textContent = calculatorData.workTypeName || '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            document.getElementById('displayMaterial').textContent = calculatorData.materialName || '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            document.getElementById('displayArea').textContent = calculatorData.area ? calculatorData.area.toFixed(2) + ' –º¬≤' : '0 –º¬≤';
            const srvNames = { delivery: '–î–æ—Å—Ç–∞–≤–∫–∞', installation: '–ú–æ–Ω—Ç–∞–∂', designer: '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è' };
            const srvText = calculatorData.services.length > 0 ? calculatorData.services.map(s => srvNames[s.id]).join(', ') : '–ù–µ—Ç';
            document.getElementById('displayServices').textContent = srvText;
            let matCost = 0, sheetsCount = 0;
            if (calculatorData.sheetArea > 0) {
                sheetsCount = Math.ceil(calculatorData.area / calculatorData.sheetArea);
                matCost = sheetsCount * calculatorData.materialPrice;
                document.getElementById('sheetsRow').style.display = 'flex';
                document.getElementById('displaySheets').textContent = sheetsCount + ' —à—Ç';
            } else {
                matCost = calculatorData.area * calculatorData.materialPrice;
                document.getElementById('sheetsRow').style.display = 'none';
            }
            let srvCost = 0;
            calculatorData.services.forEach(s => { srvCost += s.fixed + (s.perM2 * calculatorData.area); });
            const total = matCost + srvCost;
            if (matCost > 0) {
                document.getElementById('materialCostRow').style.display = 'flex';
                animateValue('displayMaterialCost', matCost);
            } else {
                document.getElementById('materialCostRow').style.display = 'none';
            }
            animateValue('displayTotal', total);
        }

        function animateValue(elementId, endValue) {
            const element = document.getElementById(elementId);
            const startValue = parseInt(element.textContent.replace(/[^0-9]/g, '')) || 0;
            const duration = 500, startTime = performance.now();
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                const currentValue = Math.floor(startValue + (endValue - startValue) * easeProgress);
                element.textContent = currentValue.toLocaleString('ru-RU') + ' ‚ÇΩ';
                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        function finalizeCalculator() {
            if (calculatorData.area === 0) { showNotification('–£–∫–∞–∂–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', 'error'); return; }
            document.getElementById('contactForm').classList.add('show');
            document.querySelector('.estimate-card').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
        }

        function downloadPDF() {
            const name = document.getElementById('clientName').value.trim();
            const phone = document.getElementById('clientPhone').value.trim();
            if (!name) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è', 'error'); return; }
            if (!validatePhone(phone)) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω', 'error'); return; }
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFontSize(20); doc.text('–°–º–µ—Ç–∞ - –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä', 20, 20);
                doc.setFontSize(12); let y = 40;
                doc.text(`–ö–ª–∏–µ–Ω—Ç: ${name}`, 20, y); y += 10;
                doc.text(`–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`, 20, y); y += 10;
                doc.text(`–î–∞—Ç–∞: ${new Date().toLocaleDateString('ru-RU')}`, 20, y); y += 20;
                doc.text(`–¢–∏–ø —Ä–∞–±–æ—Ç: ${calculatorData.workTypeName}`, 20, y); y += 10;
                doc.text(`–ú–∞—Ç–µ—Ä–∏–∞–ª: ${calculatorData.materialName}`, 20, y); y += 10;
                doc.text(`–ü–ª–æ—â–∞–¥—å: ${calculatorData.area.toFixed(2)} –º¬≤`, 20, y); y += 10;
                if (calculatorData.sheetArea > 0) {
                    const sheets = Math.ceil(calculatorData.area / calculatorData.sheetArea);
                    doc.text(`–õ–∏—Å—Ç–æ–≤: ${sheets} —à—Ç`, 20, y); y += 10;
                }
                if (calculatorData.services.length > 0) {
                    doc.text('–£—Å–ª—É–≥–∏:', 20, y); y += 10;
                    const srvNames = { delivery: '–î–æ—Å—Ç–∞–≤–∫–∞', installation: '–ú–æ–Ω—Ç–∞–∂', designer: '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è' };
                    calculatorData.services.forEach(s => { doc.text(`  - ${srvNames[s.id]}`, 20, y); y += 8; });
                }
                y += 10;
                const total = document.getElementById('displayTotal').textContent;
                doc.setFontSize(16); doc.text(`–ò–¢–û–ì–û: ${total}`, 20, y); y += 20;
                doc.setFontSize(10); doc.text('* –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–º–µ—Ä–∞', 20, y);
                doc.save(`–°–º–µ—Ç–∞_–ê—Ä–∑–∞–º–∞—Å_–î–µ–∫–æ—Ä_${Date.now()}.pdf`);
                showNotification('PDF —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ PDF:', error);
                showNotification('–û—à–∏–±–∫–∞ PDF', 'error');
            }
        }

        function sendToTelegram() {
            const name = document.getElementById('clientName').value.trim();
            const phone = document.getElementById('clientPhone').value.trim();
            if (!name) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è', 'error'); return; }
            if (!validatePhone(phone)) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω', 'error'); return; }
            const total = document.getElementById('displayTotal').textContent;
            let message = `üß± –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ - –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä\n\n`;
            message += `üë§ –ö–ª–∏–µ–Ω—Ç: ${name}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n`;
            message += `üìÖ –î–∞—Ç–∞: ${new Date().toLocaleString('ru-RU')}\n\n`;
            message += `üèóÔ∏è –¢–∏–ø —Ä–∞–±–æ—Ç: ${calculatorData.workTypeName}\n`;
            message += `üß± –ú–∞—Ç–µ—Ä–∏–∞–ª: ${calculatorData.materialName}\n`;
            message += `üìè –ü–ª–æ—â–∞–¥—å: ${calculatorData.area.toFixed(2)} –º¬≤\n`;
            if (calculatorData.sheetArea > 0) {
                const sheets = Math.ceil(calculatorData.area / calculatorData.sheetArea);
                message += `üì¶ –õ–∏—Å—Ç–æ–≤: ${sheets} —à—Ç\n`;
            }
            if (calculatorData.services.length > 0) {
                message += `\n‚úÖ –£—Å–ª—É–≥–∏:\n`;
                const srvNames = { delivery: '–î–æ—Å—Ç–∞–≤–∫–∞', installation: '–ú–æ–Ω—Ç–∞–∂', designer: '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è' };
                calculatorData.services.forEach(s => { message += `  ‚Ä¢ ${srvNames[s.id]}\n`; });
            }
            message += `\nüí∞ –ò–¢–û–ì–û: ${total}`;
            const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent('https://tsarkov.tech')}&text=${encodeURIComponent(message)}`;
            window.open(telegramUrl, '_blank');
            showNotification('Telegram –æ—Ç–∫—Ä—ã—Ç');
        }

        function submitForm() {
            const name = document.getElementById('clientName').value.trim();
            const phone = document.getElementById('clientPhone').value.trim();
            if (!name) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è', 'error'); return; }
            if (!validatePhone(phone)) { showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω', 'error'); return; }
            showNotification(`–°–ø–∞—Å–∏–±–æ, ${name}! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏`);
            setTimeout(() => {
                if (confirm('–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç?')) {
                    localStorage.removeItem('arzamas_decor_calculator');
                    location.reload();
                }
            }, 2000);
        }

        document.getElementById('clientPhone').addEventListener('input', function() { formatPhone(this); });

        /* AMK Script */

        const colorMixes = [
            { id: 100, name: '–º–∏–∫—Å 100', color: '#d4a574', price: 1080, 
              paletteImage: '/images/calcimg/100-4.jpg',
              images: { exterior: '/images/calcimg/100.jpg', interior: '/images/calcimg/100-1.jpg', balcony: '/images/calcimg/100-2.jpg' }
            },
            { id: 200, name: '–º–∏–∫—Å 200', color: '#8a8a8a', price: 1080, 
              paletteImage: '/images/calcimg/200-4.jpg',
              images: { exterior: '/images/calcimg/200.jpg', interior: '/images/calcimg/200-1.jpg', balcony: '/images/calcimg/200-2.jpg' }
            },
            { id: 241, name: '–º–∏–∫—Å 241', color: '#4a4a4a', price: 1080, 
              paletteImage: '/images/calcimg/241-4.jpg',
              images: { exterior: '/images/calcimg/241.jpg', interior: '/images/calcimg/241-1.jpg', balcony: '/images/calcimg/241-2.jpg' }
            },
            { id: 300, name: '–º–∏–∫—Å 300', color: '#c89b7b', price: 1080, 
              paletteImage: '/images/calcimg/300-4.jpg',
              images: { exterior: '/images/calcimg/300.jpg', interior: '/images/calcimg/300-1.jpg', balcony: '/images/calcimg/300-2.jpg' }
            },
            { id: 322, name: '–º–∏–∫—Å 322', color: '#8b5a3c', price: 1080, 
              paletteImage: '/images/calcimg/322-4.jpg',
              images: { exterior: '/images/calcimg/322.jpg', interior: '/images/calcimg/322-1.jpg', balcony: '/images/calcimg/322-2.jpg' }
            },
            { id: 410, name: '–º–∏–∫—Å 410', color: '#b87c6c', price: 1080, 
              paletteImage: '/images/calcimg/410-4.jpg',
              images: { exterior: '/images/calcimg/410.jpg', interior: '/images/calcimg/410-1.jpg', balcony: '/images/calcimg/410-2.jpg' }
            },
            { id: 432, name: '–º–∏–∫—Å 432', color: '#9d5a4a', price: 1080, 
              paletteImage: '/images/calcimg/432-4.jpg',
              images: { exterior: '/images/calcimg/432.jpg', interior: '/images/calcimg/432-1.jpg', balcony: '/images/calcimg/432-2.jpg' }
            },
            { id: 500, name: '–º–∏–∫—Å 500', color: '#d4926a', price: 1080, 
              paletteImage: '/images/calcimg/500-4.jpg',
              images: { exterior: '/images/calcimg/500.jpg', interior: '/images/calcimg/500-1.jpg', balcony: '/images/calcimg/500-2.jpg' }
            }
        ];

        let currentSelection = colorMixes[0];
        let currentImageType = 'exterior';

        function init() {
            renderColorPalette();
            setupEventListeners();
        }

        function renderColorPalette() {
            const palette = document.getElementById('colorPalette');
            palette.innerHTML = '';

            colorMixes.forEach((mix, index) => {
                const option = document.createElement('div');
                option.className = `color-option ${index === 0 ? 'selected' : ''}`;
                option.dataset.id = mix.id;

                option.innerHTML = `
                    <div class="color-option-bg" style="background-image: url('${mix.paletteImage}');"></div>
                    <div class="color-label">${mix.id}</div>
                `;

                option.addEventListener('click', () => selectColor(mix, option));
                palette.appendChild(option);
            });
        }

        function selectColor(mix, element) {
            currentSelection = mix;
            currentImageType = 'exterior';

            document.querySelectorAll('.color-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');

            document.getElementById('selectionText').textContent = mix.name;
            document.getElementById('priceValue').textContent = mix.price;

            updateGalleryImages();
        }

        function updateGalleryImages() {
            document.getElementById('exteriorImage').src = currentSelection.images.exterior;
            document.getElementById('interiorImage').src = currentSelection.images.interior;
            document.getElementById('balconyImage').src = currentSelection.images.balcony;
            updateActiveStates();
        }

        function updateActiveStates() {
            const items = document.querySelectorAll('.gallery-item');
            items.forEach(item => item.classList.remove('active'));

            const activeItem = document.querySelector(`[data-type="${currentImageType}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }

        function switchImage(type) {
            currentImageType = type;
            updateActiveStates();
        }

        function handleNext() {
            console.log('–í—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª:', currentSelection);
            alert(`–í—ã–±—Ä–∞–Ω: ${currentSelection.name}\n–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥...`);
        }

        function setupEventListeners() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

                    const view = btn.dataset.view;
                    if (view === 'photos') {
                        document.getElementById('photoGallery').style.display = 'flex';
                        document.getElementById('specifications').style.display = 'none';
                    } else {
                        document.getElementById('photoGallery').style.display = 'none';
                        document.getElementById('specifications').style.display = 'flex';
                    }
                });
            });

            document.querySelectorAll('.gallery-item').forEach(item => {
                item.addEventListener('click', () => {
                    const type = item.dataset.type;
                    switchImage(type);
                });
            });
        }

        init();
    

        (function() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault(); e.stopPropagation();
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const isPhotos = this.textContent.includes('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏');
                    const galleryContainer = document.querySelector('.gallery-container');
                    const characteristics = document.querySelector('.characteristics');
                    if (galleryContainer && characteristics) {
                        if (isPhotos) {
                            galleryContainer.style.display = 'flex';
                            characteristics.style.display = 'none';
                        } else {
                            galleryContainer.style.display = 'none';
                            characteristics.style.display = 'flex';
                        }
                    }
                });
            });
            document.querySelectorAll('.gallery-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault(); e.stopPropagation();
                    document.querySelectorAll('.gallery-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            const originalSelectMix = window.selectMix;
            if (typeof originalSelectMix === 'function') {
                window.selectMix = function(mix) {
                    originalSelectMix.call(this, mix);
                    calculatorData.amkMix = { id: mix.id, name: mix.name, price: mix.price };
                    calculatorData.materialPrice = mix.price;
                    saveToLocalStorage();
                    updateDisplay();
                };
            }
        })();

        window.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ê—Ä–∑–∞–º–∞—Å –î–µ–∫–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üìã –í–µ—Ä—Å–∏—è: 3.3 with logo.png');
            console.log('‚úÖ –õ–æ–≥–æ—Ç–∏–ø: logo.png');
            loadFromLocalStorage();
            updateProgressBar();
        });
    </script>
</body>
</html>
